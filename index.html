<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Independence Day Animation</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@700&display=swap" rel="stylesheet">
<style>
    body {
        margin: 0;
        overflow: hidden;
        font-family: sans-serif;
        background: #000;
    }
    canvas {
        display: block;
    }
    .footer {
    position: fixed;
    bottom: 10px;
    width: 100%;
    text-align: center;
    color: rgba(255, 255, 255, 0.6); /* Semi-transparent white */
    font-size: 16px;
    font-family: "Noto Sans Devanagari", Arial, sans-serif;
    pointer-events: none; /* no canvas interference */
}
</style>
</head>
<body>
<canvas id="canvas"></canvas>

<script>

// Color scheme
const COLORS = {
    saffron: "#FF9933",
    white: "#FFFFFF",
    green: "#138808",
    blue: "#000080"
};

let canvas = document.getElementById("canvas");
let ctx = canvas.getContext("2d");
let w, h, particles = [];
let bgShift = 0;

class Particle {
    constructor(targetX, targetY, color) {
        //random starting position of particles for animation
        this.x = Math.random() * w;
        this.y = Math.random() * h;
        this.size = 2;
        this.color = color;
        //final positions
        this.baseX = targetX;
        this.baseY = targetY;
    }
    draw() {
        ctx.shadowBlur = 8; // glow effect
        ctx.shadowColor = this.color;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0; // reset
    }
    update() {
        //move particles to their base position
        let dx = this.baseX - this.x;
        let dy = this.baseY - this.y;
        // increased speed for faster word formation
        this.x += dx / 10; 
        this.y += dy / 10;
    }
}


function resize() {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
}

//Main drawing function
function drawFinalComposition(offCtx) {
    // Clear the offscreen canvas before drawing
    offCtx.clearRect(0, 0, w, h);

    //Responsive Layout 
    const isPortrait = h > w;
    const topTextY = h * 0.18;
    const flagY = h * 0.5;
    const bottomTextY = h * 0.82;
    
    //"‡§ú‡§Ø ‡§π‡§ø‡§Ç‡§¶"
    const topFontSize = isPortrait ? w / 8 : h / 8;
    offCtx.font = `bold ${topFontSize}px "Noto Sans Devanagari", Arial, sans-serif`;
    offCtx.textAlign = "center";
    offCtx.textBaseline = "middle";
    const topGradient = offCtx.createLinearGradient(0, topTextY - topFontSize/2, 0, topTextY + topFontSize/2);
    topGradient.addColorStop(0, COLORS.saffron);
    topGradient.addColorStop(0.5, COLORS.white);
    topGradient.addColorStop(1, COLORS.green);
    offCtx.fillStyle = topGradient;
    offCtx.fillText("‡§ú‡§Ø ‡§π‡§ø‡§Ç‡§¶", w / 2, topTextY);

    //Tricolor
    const flagHeight = isPortrait ? w * 0.4 : h * 0.4;
    const flagWidth = flagHeight * 1.5;
    const x0 = (w - flagWidth) / 2;
    const y0 = flagY - flagHeight / 2;
    const bandHeight = flagHeight / 3;

    offCtx.fillStyle = COLORS.saffron;
    offCtx.fillRect(x0, y0, flagWidth, bandHeight);
    offCtx.fillStyle = COLORS.white;
    offCtx.fillRect(x0, y0 + bandHeight, flagWidth, bandHeight);
    offCtx.fillStyle = COLORS.green;
    offCtx.fillRect(x0, y0 + bandHeight * 2, flagWidth, bandHeight);

    const cx = w / 2;
    const cy = flagY;
    const radius = bandHeight / 2 * 0.8;
    offCtx.fillStyle = COLORS.blue;
    offCtx.strokeStyle = COLORS.blue;
    offCtx.lineWidth = Math.max(3, 2 * 2);
    offCtx.beginPath();
    offCtx.arc(cx, cy, radius, 0, Math.PI * 2);
    offCtx.fill();
    for (let i = 0; i < 24; i++) {
        const angle = (i * Math.PI * 2) / 24;
        offCtx.beginPath();
        offCtx.moveTo(cx, cy);
        offCtx.lineTo(cx + radius * Math.cos(angle), cy + radius * Math.sin(angle));
        offCtx.stroke();
    }

    //"‡§µ‡§Ç‡§¶‡•á ‡§Æ‡§æ‡§§‡§∞‡§Æ‡•ç"
    const bottomFontSize = isPortrait ? w / 7 : h / 7;
    offCtx.font = `bold ${bottomFontSize}px "Noto Sans Devanagari", Arial, sans-serif`;
    const bottomGradient = offCtx.createLinearGradient(0, bottomTextY - bottomFontSize/2, 0, bottomTextY + bottomFontSize/2);
    bottomGradient.addColorStop(0, COLORS.saffron);
    bottomGradient.addColorStop(0.5, COLORS.white);
    bottomGradient.addColorStop(1, COLORS.green);
    offCtx.fillStyle = bottomGradient;
    offCtx.fillText("‡§µ‡§Ç‡§¶‡•á ‡§Æ‡§æ‡§§‡§∞‡§Æ‡•ç", w / 2, bottomTextY);
    
}

function initParticles() {
    particles = [];

    //offscreen canvas to generate the final image data
    let offCanvas = document.createElement("canvas");
    let offCtx = offCanvas.getContext("2d", { willReadFrequently: true });
    offCanvas.width = w;
    offCanvas.height = h;

    // Draw to the offscreen canvas
    drawFinalComposition(offCtx);

    let imageData = offCtx.getImageData(0, 0, w, h);
    // Sample pixels from the generated image to create particles
    for (let y = 0; y < h; y += 4) {
        for (let x = 0; x < w; x += 4) {
            let index = (y * w + x) * 4;
            if (imageData.data[index + 3] > 128) {
                const r = imageData.data[index];
                const g = imageData.data[index + 1];
                const b = imageData.data[index + 2];
                const color = `rgb(${r},${g},${b})`;
                
                particles.push(new Particle(x, y, color));
            }
        }
    }
}

//animated background with tricolor gradient
function drawBackground() {
    bgShift += 0.003;
    let lightShift = Math.sin(bgShift) * 3; //Dynamic non static bg

    let grad = ctx.createLinearGradient(0, 0, 0, h);

    grad.addColorStop(0, `hsl(30, 45%, ${25 + lightShift}%)`);    // Softer saffron
    grad.addColorStop(0.5, `hsl(210, 15%, ${30 + lightShift}%)`);  // Softer brighter cool gray (for white)
    grad.addColorStop(1, `hsl(140, 35%, ${25 + lightShift}%)`);  // Softer green

    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, w, h);
}

function animate() {
    drawBackground();
    for (let p of particles) {
        p.update();
        p.draw();
    }
    requestAnimationFrame(animate);
}

//  Initialization Logic
function initialize() {
    resize();
    initParticles();
}

//Load custom font before starting animation
document.fonts.ready.then(() => {
    initialize();
    animate();
});

// Reinitialize particles on resize after they load initially
window.addEventListener("resize", initialize);

</script>
<div class="footer">‡§ï‡•á‡§§‡§ï‡•Ä ‡§ï‡•Å‡§≤‡§ï‡§∞‡•ç‡§£‡•Ä üòÅ</div>
</body>
</html>
